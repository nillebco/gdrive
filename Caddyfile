http://{$DOMAIN} {
	bind fd/3 {
		protocols h1
	}
	log

	# Proxy OAuth routes to the backend
	handle /auth/* {
		reverse_proxy gdrive:8080
	}

	# Proxy health check to the backend
	handle /health {
		reverse_proxy gdrive:8080
	}

	# Serve static files from the web folder for everything else
	handle {
		root * /srv/web
		try_files {path} {path}/ /index.html
		file_server
	}
}

https://{$DOMAIN} {
	bind fd/4 {
		protocols h1 h2
	}
	bind fdgram/5 {
		protocols h3
	}
	log

	# Proxy OAuth routes to the backend
	handle /auth/* {
		reverse_proxy gdrive:8080
	}

	# Proxy health check to the backend
	handle /health {
		reverse_proxy gdrive:8080
	}

	# Serve static files from the web folder for everything else
	handle {
		root * /srv/web
		try_files {path} {path}/ /index.html
		file_server
	}
}
